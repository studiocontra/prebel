<template>
  <div class="hero hero--home">
    <div class="hero--home__bg">
      <prismic-image :field="bgImage" />
    </div>

    <div class="container">
      <div class="row">
        <div class="col-xl-8 col-xx-7">
          <h1 class="title title--lg">
            {{ headline }}
          </h1>

          <div class="row">
            <div class="col-lg-9">
              <PrismicRichText :field="content" class="text" />
            </div>
          </div>

        </div>
      </div>

      <template v-if="showForm">
        <button @click="toggleModal" class="toggle-form">
          <svg xmlns="http://www.w3.org/2000/svg" width="86" height="86" fill="none">
            <circle cx="43" cy="43" r="43" fill="#4278FA" />
            <g>
              <path fill="#fff"
                d="M42.206 72.874c2.043 0 3.432 1.412 3.432 3.573 0 2.093-1.29 3.553-3.432 3.553-1.985 0-3.08-1.256-3.236-2.765h1.154c.078.964.801 1.811 2.082 1.811 1.408 0 2.278-1.08 2.278-2.6 0-1.606-.997-2.618-2.278-2.618-1.261 0-1.975.925-2.082 1.684H38.97c.196-1.402 1.31-2.638 3.236-2.638Z" />
              <path fill="#fff"
                d="M36.58 72.277c1.87.37 3.047 1.913 2.6 4.147-.446 2.235-2.126 3.212-3.996 2.842-1.86-.369-3.037-1.912-2.591-4.146.446-2.235 2.127-3.212 3.987-2.843Zm-.187.935c-1.191-.226-2.33.432-2.669 2.132-.341 1.709.465 2.712 1.65 2.967 1.195.256 2.334-.402 2.675-2.11.34-1.7-.456-2.76-1.656-2.989Z" />
              <path fill="#fff"
                d="m26.845 76.382-1.03-.425 2.62-6.296 1.39.574.96 6.19 2.057-4.946 1.021.421-2.619 6.296-1.382-.57-.959-6.191-2.058 4.947ZM26.352 68.271l-3.249 4.84 1.707 1.136-.554.826-4.34-2.888.553-.826 1.708 1.136 3.248-4.84.927.616ZM14.54 69.688l1.55-.261.49.488-1.147.661-.892-.888Zm5.587-6.704-.788 1.652 1.935 1.927 1.66-.785.83.826-6.68 2.988-.787-.785 3-6.65.83.827Zm.193 4.033-1.438-1.431-1.306 2.733 2.744-1.302ZM17.809 59.576c1.135 1.692.727 3.626-1.077 4.826-1.748 1.163-3.684.906-4.874-.867-1.103-1.643-.662-3.247.51-4.215l.642.955c-.761.6-1.067 1.67-.355 2.73.782 1.166 2.168 1.286 3.436.442 1.341-.892 1.633-2.28.921-3.34-.7-1.045-1.87-1.122-2.563-.79l-.641-.954c1.279-.617 2.93-.381 4 1.213ZM15.252 55.163 9.851 57.39l.785 1.889-.921.38-1.998-4.803.921-.38.786 1.888 5.402-2.227.426 1.025ZM13.026 47.323l-1.577.938.534 2.673 1.818.266.229 1.146-7.22-1.21-.217-1.09 6.204-3.868.23 1.145Zm-2.09 3.461-.396-1.986-2.611 1.55 3.008.436Z" />
              <path fill="#fff"
                d="M6 41.682v-1.11h6.844v1.5l-5.377 3.25h5.377v1.1H6v-1.489l5.377-3.251H6ZM13.6 37.605c-.372 1.862-1.922 3.034-4.166 2.59-2.244-.444-3.225-2.118-2.853-3.98.37-1.852 1.92-3.024 4.163-2.58 2.244.445 3.226 2.118 2.856 3.97Zm-.94-.186c.227-1.185-.434-2.319-2.14-2.657-1.717-.34-2.725.463-2.98 1.643-.258 1.19.403 2.323 2.12 2.663 1.706.338 2.771-.453 3-1.649Z" />
              <path fill="#fff"
                d="M15.246 32.157c-.64 1.538-2.058 2.25-3.42 1.76l.445-1.07c.862.293 1.723-.174 2.09-1.055.381-.918.086-1.682-.483-1.917-.597-.246-1.09.025-1.603 1.257l-.146.35c-.46 1.107-1.52 1.797-2.576 1.361-.976-.402-1.65-1.607-.976-3.226.648-1.556 1.962-2.12 3.3-1.674l-.445 1.07c-.894-.294-1.609.128-1.96.973-.375.9-.115 1.523.526 1.787.524.216.909.08 1.425-1.161l.097-.234c.576-1.385 1.751-1.997 2.8-1.564.947.39 1.622 1.67.926 3.343ZM23.593 17.836l-.521-.777 2.601-1.73.522.777-2.602 1.73ZM42.794 14.126c-2.043 0-3.432-1.412-3.432-3.573C39.362 8.46 40.652 7 42.794 7c1.985 0 3.08 1.256 3.236 2.765h-1.154c-.078-.964-.801-1.811-2.082-1.811-1.408 0-2.278 1.08-2.278 2.6 0 1.606.997 2.618 2.278 2.618 1.261 0 1.975-.925 2.082-1.684h1.154c-.196 1.402-1.31 2.638-3.236 2.638Z" />
              <path fill="#fff"
                d="M48.42 14.723c-1.87-.37-3.047-1.913-2.6-4.148.446-2.234 2.127-3.211 3.996-2.84 1.86.368 3.037 1.911 2.591 4.145-.446 2.234-2.127 3.212-3.987 2.843Zm.187-.935c1.191.226 2.33-.432 2.669-2.132.341-1.709-.465-2.712-1.65-2.967-1.195-.256-2.334.401-2.675 2.11-.34 1.7.456 2.76 1.656 2.989Z" />
              <path fill="#fff"
                d="m58.155 10.618 1.03.425-2.62 6.296-1.39-.574-.96-6.19-2.057 4.946-1.021-.421 2.619-6.296 1.382.57.959 6.191 2.058-4.947ZM58.648 18.729l3.249-4.84-1.707-1.136.554-.826 4.34 2.888-.553.826-1.708-1.136-3.248 4.84-.927-.616ZM70.46 17.312l-1.55.261-.49-.489 1.147-.66.892.888Zm-5.587 6.704.788-1.652-1.935-1.927-1.66.785-.83-.826 6.68-2.988.787.785-3 6.65-.83-.827Zm-.193-4.033 1.438 1.431 1.306-2.733-2.744 1.302ZM67.191 27.424c-1.135-1.692-.728-3.626 1.077-4.826 1.748-1.163 3.684-.906 4.874.867 1.103 1.643.662 3.247-.51 4.215l-.642-.955c.761-.6 1.067-1.67.355-2.73-.782-1.166-2.168-1.286-3.436-.442-1.341.892-1.633 2.28-.921 3.34.7 1.045 1.87 1.122 2.563.79l.641.954c-1.279.617-2.93.381-4-1.213ZM69.748 31.837l5.401-2.228-.785-1.889.921-.38 1.998 4.803-.921.38-.786-1.888-5.402 2.227-.426-1.025ZM71.974 39.677l1.577-.938-.534-2.673-1.818-.266-.229-1.146 7.22 1.21.217 1.09-6.204 3.868-.23-1.145Zm2.09-3.461.396 1.986 2.611-1.55-3.008-.436Z" />
              <path fill="#fff"
                d="M79 45.318v1.11h-6.844v-1.5l5.377-3.25h-5.377v-1.1H79v1.489l-5.377 3.251H79ZM71.4 49.395c.372-1.862 1.922-3.034 4.166-2.59 2.244.444 3.225 2.118 2.853 3.98-.37 1.852-1.92 3.024-4.163 2.58-2.244-.445-3.226-2.118-2.856-3.97Zm.94.186c-.227 1.185.434 2.319 2.14 2.657 1.717.34 2.725-.463 2.98-1.643.258-1.19-.403-2.323-2.12-2.663-1.706-.338-2.771.453-3 1.649Z" />
              <path fill="#fff"
                d="M69.754 54.843c.64-1.538 2.058-2.25 3.42-1.76l-.445 1.07c-.862-.293-1.723.174-2.09 1.055-.381.918-.086 1.682.483 1.917.597.246 1.09-.025 1.603-1.257l.146-.35c.46-1.107 1.52-1.797 2.576-1.361.976.402 1.65 1.607.976 3.226-.648 1.556-1.962 2.12-3.3 1.674l.445-1.07c.894.294 1.609-.128 1.96-.973.375-.9.115-1.523-.526-1.787-.524-.216-.909-.08-1.425 1.161l-.097.234c-.576 1.385-1.751 1.996-2.8 1.564-.948-.39-1.622-1.67-.926-3.343ZM61.407 69.164l.521.777-2.601 1.73-.522-.777 2.602-1.73Z" />
            </g>
            <path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5"
              d="M33 39.5c0-3.5 2-5 5-5h10c3 0 5 1.5 5 5v7c0 3.5-2 5-5 5H38" />
            <path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5"
              d="m48 40-3.13 2.5c-1.03.82-2.72.82-3.75 0L38 40M33 47.5h6M33 43.5h3" />
          </svg>
        </button>
      </template>

      <template v-if="showModal">
        <div class="modal">
          <div class="modal-content">
            <button @click="toggleModal" class="modal-close">
              <span class="close">&times;</span>
            </button>
            <picture class="modal-picture">
              <prismic-image :field="modalData.image" />
            </picture>
            <div class="modal-form">
              <div class="modal-form-content">
                <h3>{{ modalData.headline }}</h3>
                <p>{{ modalData.description }}</p>
              </div>
              <form @submit.prevent="handleSubmit" class="modal-form-inputs">
                <input v-model="name" type="text" name="name" :placeholder="modalData.inputs[0].name" required></input>
                <input v-model="phone" type="text" name="phone" :placeholder="modalData.inputs[0].phone" required></input>
                <input v-model="email" type="email" name="email" :placeholder="modalData.inputs[0].email" required></input>
                <textarea v-model="message" :placeholder="modalData.inputs[0].message" name="message" required></textarea>
                <button type="submit">{{ modalData.button_label }} <svg width="11" height="14" viewBox="0 0 14 12" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M11.7491 5.90347L12.9413 5.90347L12.1058 5.05307L8.54658 1.43009C8.50773 1.39055 8.50772 1.32718 8.54655 1.28763C8.58639 1.24704 8.65179 1.24704 8.69164 1.28763L13.2343 5.91503C13.2776 5.96398 13.2772 6.03736 13.2351 6.08535L8.69285 10.7123C8.65298 10.7529 8.58754 10.7529 8.54767 10.7123L8.19087 11.0626L8.54767 10.7123C8.50883 10.6727 8.50883 10.6094 8.54768 10.5698L12.1053 6.94685L12.9403 6.09653L11.7486 6.09653L0.596139 6.09653C0.542828 6.09653 0.49961 6.05331 0.49961 6C0.49961 5.94669 0.542827 5.90347 0.596138 5.90347L11.7491 5.90347Z"
                      fill="#4278FA" stroke="#EDEBE3" />
                  </svg>
                </button>
              </form>
            </div>
          </div>
        </div>
      </template>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
const props = defineProps({
  headline: String,
  content: Object,
  bgImage: {
    type: [Object, Boolean],
    default: null,
  },
  showForm: Boolean
});

const { client } = usePrismic();
const { localeProperties } = useI18n();
const { value: { iso, code } } = localeProperties;

const { data } = await useAsyncData("[modal]", () =>
  client.getSingle("modal", {lang: iso})
);

const modalData = data.value.data;
console.log(modalData)

const showModal = ref(false)
const name = ref(null)
const email = ref(null)
const phone = ref(null)
const message = ref(null)

function toggleModal() {
  showModal.value = !showModal.value
}

onMounted(() => {
  document.querySelectorAll("[data-row]").forEach((row, index) => {
    setTimeout(() => {
      row.classList.remove('hidden');
    }, 500 * (index + 1));
  })
});
</script>

<style lang="scss" scoped>
@import "@scss/components/slices/hero/base";
@import "@scss/components/slices/hero/homepage";
</style>